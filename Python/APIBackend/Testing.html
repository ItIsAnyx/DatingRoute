<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Yandex Maps — Маршрут из встроенного JSON</title>
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=cf0d0074-c1c2-490f-b5eb-3f9072f7ecb2" type="text/javascript"></script>
  <style>
    html,body,#map { height:100%; margin:0; padding:0; }
    #map { width:100%; height:100vh; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    // Встроенный JSON для маршрута
    const routeJson = {
     "type": "driving",
     "points": [
      { "name": "Красная площадь", "coords": [55.753930, 37.620795] },
      { "name": "Театральная площадь", "coords": [55.758740, 37.619884] },
      { "name": "Арбат", "coords": [55.752218, 37.604048] },
      { "name": "Парк Горького", "coords": [55.729876, 37.601089] }
  ],
  "params": {
    "routingMode": "pedestrian",
    "avoidTolls": false
  }
};


    let map, multiRoute;

    function buildRouteFromJson(json) {
      const referencePoints = json.points.map(p => p.request || p.coords.join(','));

      if (multiRoute) {
        map.geoObjects.remove(multiRoute);
      }

      multiRoute = new ymaps.multiRouter.MultiRoute({
        referencePoints: referencePoints,
        params: {
          routingMode: json.params.routingMode || 'auto'
        }
      }, {
        boundsAutoApply: true
      });

      multiRoute.model.events.add('requestsuccess', () => {
        console.log('Маршрут успешно построен');
      });

      multiRoute.model.events.add('requestfail', () => {
        console.error('Не удалось построить маршрут');
      });

      map.geoObjects.add(multiRoute);
    }

    function init() {
      map = new ymaps.Map('map', {
        center: [55.751574, 37.573856],
        zoom: 11,
        controls: ['zoomControl']
      });

      buildRouteFromJson(routeJson);
    }

    ymaps.ready(init);
  </script>
</body>
</html>
